(function(e){function t(t){for(var o,a,s=t[0],l=t[1],u=t[2],d=0,m=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&m.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);c&&c(t);while(m.length)m.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={app:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("1da1"),i=n("3835"),r=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("b64b"),n("4fad"),n("2ca0"),n("5319"),n("ac1f"),n("caad"),n("2532"),n("b0c0"),n("d3b7"),n("25f0"),n("a434"),n("2b3d"),n("3ca3"),n("ddb0"),n("841c"),n("a026")),a=n("1157"),s=n.n(a),l=n("260b"),u=(n("ea7b"),n("ee68"),n("5111")),c=n("e37d"),d={g:1,mg:.001,kg:1e3,ug:1e-6,ng:1e-9},m={l:1,ml:.001,ul:1e-6,nl:1e-9,litres:1,litre:1,liters:1,liter:1},_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"computed",staticStyle:{display:"inline-block"}},[n("div",{staticClass:"button_holder_flask"},[n("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.vol_toggle_large_tooltip,expression:"vol_toggle_large_tooltip"}],staticClass:"fas change-input-type-button toggler",class:[e.input_type_button_image,e.vol_toggle_hint_internal&e.vol_toggle_hint?"highlight":""],attrs:{title:"Toggle between measuring out mass and volume"},on:{click:function(t){return e.toggleType()}}})]),"weight"==e.input_method?n("div",{staticStyle:{display:"inline-block"}},[n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.needed_amount_mass[1],expression:"needed_amount_mass[1]"}],staticClass:"needed_number"},[e._v(e._s(e.needed_amount_mass[0]))]),n("unit",{key:"mass",attrs:{type:"mass"},model:{value:e.content.mass_unit,callback:function(t){e.$set(e.content,"mass_unit",t)},expression:"content.mass_unit"}})],1):e._e(),"volume"==e.input_method?n("div",{staticStyle:{display:"inline-block"}},[n("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.needed_amount_volume[1],expression:"needed_amount_volume[1]"}],staticClass:"needed_number"},[e._v(e._s(e.needed_amount_volume[0]))]),n("unit",{key:"vol",staticClass:"vol_unit2",attrs:{type:"vol"},model:{value:e.content.vol_unit,callback:function(t){e.$set(e.content,"vol_unit",t)},expression:"content.vol_unit"}}),e._v(" of "),n("conc_and_unit",{model:{value:e.content.stock_concentration,callback:function(t){e.$set(e.content,"stock_concentration",t)},expression:"content.stock_concentration"}}),e._v(" stock ")],1):e._e()])},p=[],h=(n("35b3"),n("a9e3"),n("99af"),n("38cf"),"???"),v=4,f="Unable to calculate the required value: you need to add a molecular weight to this reagent to make this conversion. Either choose a reagent from the suggestion list or click on the cog icon.";function g(e,t){return parseFloat(t.toPrecision(e))}function b(e,t){if("undefined"===typeof t||null===t)return"";if(0===t)return"0";var n=g(e,t),o=Math.floor(n),i=Math.abs(o-n)<Number.EPSILON,r=String(o).length,a=String(n).length;if(r>e)return String(o);var s=i?e-r:e-a+1;return s>0?i?"".concat(String(o),".").concat("0".repeat(s)):"".concat(String(n)).concat("0".repeat(s)):String(n)}var y={props:["final_volume","mw","desired_concentration","value","vol_toggle_hint"],data:function(){return{content:this.value,vol_toggle_hint_internal:!0}},methods:{toggleType:function(){this.vol_toggle_hint_internal=!1,this.desired_concentration_is_volumetric&&alert("Since your desired concentration is specified in volumetric units, you must measure out a volume."),"weight"==this.content.chosen_input_method?this.content.chosen_input_method="volume":this.content.chosen_input_method="weight"}},computed:{vol_toggle_large_tooltip:function(){return this.vol_toggle_hint_internal&this.vol_toggle_hint?"Press to toggle between measuring volume and mass":""},input_method:function(){return this.desired_concentration_is_volumetric?"volume":this.content.chosen_input_method},desired_concentration_is_volumetric:function(){return![null,"grams","moles"].includes(this.desired_concentration.type_per_litre)},needed_amount_mass:function(){if(!this.final_volume)return[h,"Unable to calculate the required value: please enter a valid total volume above"];if(void 0==d[this.content.mass_unit])return[h,"Unable to calculate the required value: please enter a valid mass unit to the right (e.g. mg)"];if(!this.desired_concentration.number)return[h,"Unable to calculate the required value: please enter a valid desired concentration"];if("grams"==this.desired_concentration.type_per_litre){var e=d[this.content.mass_unit],t=this.final_volume*this.desired_concentration.number/e;return[b(v,t),""]}if(this.mw>0&"moles"==this.desired_concentration.type_per_litre){var n=d[this.content.mass_unit],o=this.final_volume*this.desired_concentration.number*this.mw/n;return[b(v,o),""]}return this.mw?[h,"Unable to calculate the required value: you seem to be trying to convert between incompatible types"]:[h,f]},needed_amount_volume:function(){if(!this.final_volume)return[h,"Unable to calculate the required value: please enter a valid total volume above"];if(void 0==m[this.content.vol_unit])return[h,"Unable to calculate the required value: please enter a valid volume unit to the right (e.g. ml)"];if(!this.desired_concentration.number)return[h,"Unable to calculate the required value: please enter a valid desired concentration"];if(!this.content.stock_concentration.number)return[h,"Unable to calculate the required value: please enter a valid stock concentration to the right"];if(this.desired_concentration.type_per_litre==this.content.stock_concentration.type_per_litre){var e=m[this.content.vol_unit],t=this.final_volume*this.desired_concentration.number/(this.content.stock_concentration.number*e);return[b(v,t),""]}if("moles"==this.desired_concentration.type_per_litre&"grams"==this.content.stock_concentration.type_per_litre){if(!this.mw)return[h,f];var n=m[this.content.vol_unit],o=this.final_volume*this.desired_concentration.number/(this.content.stock_concentration.number*n/this.mw);return[b(v,o),""]}if("grams"==this.desired_concentration.type_per_litre&"moles"==this.content.stock_concentration.type_per_litre){if(!this.mw)return[h,f];var i=m[this.content.vol_unit],r=this.final_volume*this.desired_concentration.number/(this.content.stock_concentration.number*i*this.mw);return[b(v,r),""]}return[h,"error: you seem to be trying to convert between incompatible types"]},input_type_button_image:function(){return"weight"==this.input_method?"fa-balance-scale-right":"fa-flask"}},watch:{content:{handler:function(){this.$emit("input",this.content)},deep:!0}}},w=y,k=n("2877"),$=Object(k["a"])(w,_,p,!1,null,null,null),x=$.exports,S=n("1881"),O=n.n(S);r["a"].use(c["a"],{defaultHtml:!1}),r["a"].component("vue-simple-suggest",u["a"]),r["a"].component("needed_amount",x);var j={apiKey:"AIzaSyAbcpPTlSV3YaY3WHVSIV_-G2IV-6kGzyE",authDomain:"mixology-1b19e.firebaseapp.com",projectId:"mixology-1b19e",storageBucket:"mixology-1b19e.appspot.com",messagingSenderId:"372110169446",appId:"1:372110169446:web:c58d451c520df31b1aa4a7"};l["a"].initializeApp(j),r["a"].use(O.a);var C=Array(),M=[];function U(e){var t=document.getElementById("hidden_"+e),n=document.getElementById("input_"+e);t.innerText=n.value;var o=t.clientWidth+10,i=document.getElementById("mw_"+e);null!=i&&(o=Math.min(o,200),document.getElementById("mw_"+e).style.left=o+"px")}s.a.getJSON("masses.json",(function(e){console.log(e),C=e,M=Object.keys(e).sort((function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})),_e()})),window.run_thing=U;for(var N={},E=0,P=Object.entries(d);E<P.length;E++)for(var I=Object(i["a"])(P[E],2),q=I[0],L=I[1],A=0,T=Object.entries(m);A<T.length;A++){var V=Object(i["a"])(T[A],2),D=V[0],K=V[1],W=q+"/"+D,B=L/K,R="grams";N[W]={value:B,type_per_litre:R}}N["% (w/v)"]={value:10,type_per_litre:"grams"};for(var F=0,z=Object.entries(m);F<z.length;F++){var J=Object(i["a"])(z[F],2),Y=J[0],G=J[1],H="mol/"+Y,Z=1/G,X="moles";N[H]={value:Z,type_per_litre:X}}N["M"]={value:1,type_per_litre:"moles"},N["mM"]={value:.001,type_per_litre:"moles"},N["uM"]={value:1e-6,type_per_litre:"moles"},N["nM"]={value:1e-9,type_per_litre:"moles"};for(var Q=0,ee=Object.entries(m);Q<ee.length;Q++){var te=Object(i["a"])(ee[Q],2),ne=te[0],oe=te[1],ie="units/"+ne,re=1/oe,ae="units";N[ie]={value:re,type_per_litre:ae}}N["% (v/v)"]={value:.01,type_per_litre:"litres"},N["X"]={value:1,type_per_litre:"x"};var se=Object.keys(d).sort(),le=Object.keys(N).sort(),ue=Object.keys(m).sort();console.log(N),r["a"].component("unit",{props:["value","type"],data:function(){return{content:this.value}},methods:{unitKeyDown:function(e){"Backspace"==e.code&&0==this.$refs.unit_input.inputElement.selectionEnd&&(this.$emit("backspace_too_far","true"),e.preventDefault(),e.stopPropagation())},filterFunction:function(e,t){return e.toLowerCase().replace(" ","").startsWith(t.toLowerCase().replace(" ",""))},list_of_units:function(){return"conc"==this.type?le:"mass"==this.type?se:"vol"==this.type?ue:void 0}},computed:{invalid_unit:function(){return!this.list_of_units().includes(this.content)}},watch:{content:function(e){this.$emit("input",e)}},template:'<div class="unit" style="display:inline-block">\n      <vue-simple-suggest :filter="filterFunction"\n      v-model="content" :class="{invalid_unit:invalid_unit}"\n      :placeholder="type+\' unit\'"\n      :list="list_of_units()"\n      :filter-by-query="true"  class="unit_input" ref="unit_input">\n      <input :placeholder="type+\' unit\'" type="text" autocomplete="off" v-model="content" v-on:keydown="unitKeyDown">\n    </vue-simple-suggest>\n      </div>'}),r["a"].component("reagent",{props:["uid","manual_mw","value"],data:function(){return{content:this.value,masses_data:C,reagentsList:function(){return M},filterFunction:function(e,t){return e.toLowerCase().replace(" ","").startsWith(t.toLowerCase().replace(" ",""))}}},watch:{"content.name":{immediate:!1,handler:function(){this.$emit("nameChange"),this.$emit("input",this.content),console.log("name change"),this.UpdateMW()}},manual_mw:{immediate:!0,handler:function(){this.UpdateMW()}},"content.mw":{immediate:!0,handler:function(){console.log("mw_change",this.content.mw),this.$emit("input",this.content)}}},methods:{UpdateMW:function(){null!=this.manual_mw?this.content.mw=this.manual_mw:this.reagentsList().includes(this.content.name)?this.content.mw=C[this.content.name]:(console.log("setting to null"),this.content.mw=null),setTimeout("run_thing('"+this.uid+"')",1)},Update:function(){setTimeout("run_thing('"+this.uid+"')",1)}},template:'<div class="reagent" style="display:inline-block">\n          <vue-simple-suggest v-on:select="Update"\n          placeholder="reagent"\n          v-model="content.name"\n          :list="reagentsList"\n          :filter="filterFunction"\n          :filter-by-query="true">\n          <div class="mw" v-if="content.mw != null" :id="\'mw_\'+uid">(MW: {{content.mw}})</div>\n          <input  spellcheck="false" v-model="content.name" autocomplete="off" placeholder="reagent" type="search"  v-on:input="Update" :id="\'input_\'+uid"> \n          <div :id="\'hidden_\'+uid" style="width: auto;\n          display: inline-block;\n          visibility: hidden;\n          position: fixed;\n          overflow:auto;" class="measuring_tape">\n          </div>\n        </vue-simple-suggest>\n          </div>'}),r["a"].component("reagent_line",{props:["uid","final_volume","value","vol_toggle_hint"],data:function(){return{content:this.value,count:0,hover:!1,modalise:function(){console.log(this),this.$modal.show("trash_modal_"+this.uid)},unmodalise:function(){console.log(this),this.$modal.hide("trash_modal_"+this.uid)},modalise_settings:function(){console.log(this),this.$modal.show("settings_modal_"+this.uid)},unmodalise_settings:function(){console.log(this),this.$modal.hide("settings_modal_"+this.uid)},deleteMe:function(){console.log("delete me",this.uid),this.$emit("deleteme",this.uid)}}},computed:{displayName:function(){return""==this.content.reagent_info.name?"unnamed chemical":this.content.reagent_info.name}},watch:{content:{handler:function(e){this.$emit("input",this.content)},deep:!0}},template:'\n<div class="reagent_line" @mouseover="hover = true"\n    @mouseleave="hover = false">\n    <modal :name="\'settings_modal_\'+uid">\n   <h3> {{displayName}}</h3>\n          \n          Custom molecular mass: <input type="number"  step="any"  placeholder="0.00" v-model="content.manual_mw"  class="classic"/>\n       <div><button @click="unmodalise_settings()">OK</button></div>\n          </modal>\n    <modal :name="\'trash_modal_\'+uid">\n          Are you sure you want to delete  {{displayName}}?\n          <button  v-on:click="deleteMe()">Yes</button> <button v-on:click="unmodalise()">No</button>\n        </modal>\n    <div><conc_and_unit v-model="content.desired_concentration"/><reagent @nameChange="content.manual_mw = null" :manual_mw="content.manual_mw" :uid="uid" v-model="content.reagent_info" /><needed_amount :vol_toggle_hint="vol_toggle_hint" :mw="content.reagent_info.mw" :final_volume="final_volume" :desired_concentration="content.desired_concentration" v-model="content.needed_amount"></needed_amount><div style="display:inline-block" class="buttons_container" >&nbsp;<div  v-if="hover"  class="buttons"><i  v-on:click="modalise_settings()" title="Set molecular weight" class="fas fa-cog weight-button"></i> &nbsp;<i title="Delete" class="fas fa-trash trash-button" v-on:click="modalise()"></i></div></div>\n    </div>\n\n    \n    \n    \n    </div>\n    '}),r["a"].component("conc_and_unit",{props:["value"],data:function(){return{content:this.value}},methods:{onbackspacetoofar:function(){console.log("too far");this.content.raw_number;this.$refs.number.focus(),this.$refs.number.type="text",this.$refs.number.selectionStart=this.$refs.number.selectionEnd=this.$refs.number.value.toString().length,this.$refs.number.type="number"},numberKeypress:function(e){var t=String.fromCharCode(e.keyCode),n=/[a-zA-Z%]/.test(t);n&&(e.preventDefault(),console.log(this.$refs.unit.$refs.unit_input),this.$refs.unit.content=t,this.$refs.unit.$refs.unit_input.value=t,this.$refs.unit.$refs.unit_input.$refs.inputSlot.firstChild.focus())},updateValue:function(){N[this.value.raw_unit]?(this.value.type_per_litre=N[this.value.raw_unit].type_per_litre,this.value.number=this.value.raw_number*N[this.value.raw_unit].value,this.$emit("input",this.value)):(console.log("invalid_unit"),this.value.number=null,this.value.type_per_litre=null,this.$emit("input",this.value))}},watch:{"value.raw_unit":function(){this.updateValue()},"value.raw_number":function(){this.updateValue()}},template:'<div style="display:inline-block"><input ref="number" type="number" v-on:keypress="numberKeypress" step="any" placeholder="conc." class="number" v-model="value.raw_number"></input><unit @backspace_too_far="onbackspacetoofar" ref="unit" type="conc" v-model="value.raw_unit" /></div>'}),r["a"].component("vol_and_unit",{props:["num_hint","unit_hint","value"],data:function(){return{content:this.value}},methods:{onbackspacetoofar:function(){console.log("too far");this.content.raw_number;this.$refs.number.focus(),this.$refs.number.type="text",this.$refs.number.selectionStart=this.$refs.number.selectionEnd=this.$refs.number.value.toString().length,this.$refs.number.type="number"},numberKeypress:function(e){var t=String.fromCharCode(e.keyCode),n=/[a-zA-Z%]/.test(t);n&&(e.preventDefault(),console.log(this.$refs.unit.$refs.unit_input),this.$refs.unit.content=t,this.$refs.unit.$refs.unit_input.value=t,this.$refs.unit.$refs.unit_input.$refs.inputSlot.firstChild.focus())},updateValue:function(){var e=m[this.content.raw_unit];e?(this.content.computed_value_in_litres=this.content.raw_number*m[this.content.raw_unit],this.$emit("input",this.content)):(this.content.computed_value_in_litres=null,this.$emit("input",this.content))}},watch:{"content.raw_unit":{immediate:!0,handler:function(){this.updateValue()}},"content.raw_number":{immediate:!0,handler:function(){this.updateValue()}}},template:'<div style="display:inline-block"><input type="number" v-on:keypress="numberKeypress" step="any" :title="num_hint" placeholder="vol." class="number" v-model="content.raw_number"></input><unit @backspacetoofar="onbackspacetoofar" ref="unit" :title="unit_hint" type="vol" v-model="content.raw_unit" class="vol_unit"/></div>'});var ce={buffer_name:null,counter:4,reagents_store:[],notes_store:[],model:"",about_open:!1,video_open:!1,final_volume:{raw_number:null,raw_unit:null,computed_value_in_litres:null},onDeleteMe:function(e){console.log(this),console.log(e);var t=-1;for(var n in ce.reagents_store)ce.reagents_store[n].uid==e&&(t=n);console.log(t),t>-1&&ce.reagents_store.splice(t,1)},deleteNote:function(e){console.log(this),console.log(e);var t=-1;for(var n in ce.notes_store)ce.notes_store[n].uid==e&&(t=n);console.log(t),t>-1&&ce.notes_store.splice(t,1)}};function de(){return me.apply(this,arguments)}function me(){return me=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,o,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=new URLSearchParams(window.location.search),n=t.get("recipe"),console.log(n),n){e.next=5;break}return e.abrupt("return");case 5:return o=ve.collection("recipes").doc(n),e.next=8,o.get();case 8:if(i=e.sent,i.exists){e.next=14;break}return console.log("No such document!"),e.abrupt("return");case 14:console.log("good");case 15:r=JSON.parse(i.data().json),console.log(r),r&&(ce["final_volume"]=r["final_volume"],ce["reagents_store"]=r["reagents_store"],ce["notes_store"]=r["notes_store"],ce["buffer_name"]=r["buffer_name"]);case 18:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}function _e(){return pe.apply(this,arguments)}function pe(){return pe=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de();case 2:document.getElementById("spinner").style.display="none",new r["a"]({el:"#app",data:ce,computed:{compoundTitle:function(){return null==this.final_volume.computed_value_in_litres?"First, please enter a final volume above, with a unit":""}},methods:{AddCompound:function(){window.onbeforeunload=function(){return!0};var e=0;for(var t in ce.reagents_store)e=Math.max(ce.reagents_store[t].uid,e);ce.reagents_store.push({uid:e+1,info:{desired_concentration:{number:null,type_per_litre:null,raw_unit:null,raw_number:null},manual_mw:null,reagent_info:{name:null,mw:null},needed_amount:{mass_unit:null,chosen_input_method:"weight",vol_unit:"",stock_concentration:{raw_unit:null,raw_number:null,number:null,type_per_litre:null}}}}),ce.counter++},AddNote:function(){var e=0;for(var t in ce.notes_store)e=Math.max(ce.notes_store[t].uid,e);ce.notes_store.push({uid:e+1,text:"",hover:!1}),ce.counter++}}}),s()(".overlay").hide();case 5:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}function he(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t}var ve=l["a"].firestore();function fe(){return ge.apply(this,arguments)}function ge(){return ge=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,o,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("test"),t=Date.now(),n={notes_store:ce.notes_store,final_volume:ce.final_volume,buffer_name:ce.buffer_name,reagents_store:ce.reagents_store},o=JSON.stringify(n),i={json:o,time:t,version:1},r=he(10),e.next=8,ve.collection("recipes").doc(r).set(i);case 8:e.sent,window.onbeforeunload=null,console.log("/?recipe="+r),window.location.href="/?recipe="+r;case 12:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}window.permalink=fe}});
//# sourceMappingURL=app.8cd90c6e.js.map